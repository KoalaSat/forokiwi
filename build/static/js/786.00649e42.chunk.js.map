{"version":3,"file":"static/js/786.00649e42.chunk.js","mappings":"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","sources":["app/pages/ExternalForumList/index.tsx"],"sourcesContent":["import { Avatar, Breadcrumb, Button, Col, Row, Select, Skeleton, Table, TableColumnsType, Typography, theme } from \"antd\";\nimport Layout, { Content } from \"antd/es/layout/layout\"\nimport PeopleAltIcon from '@mui/icons-material/PeopleAlt';\nimport { useContext, useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport LanguageIcon from '@mui/icons-material/Language';\nimport { ForumsButtons } from \"app/components/ForumsButtons\";\nimport { NDKEvent, NDKFilter } from \"@nostr-dev-kit/ndk\";\nimport { UseNostrStoreType, NostrContext } from \"app/contexts/NostrContext\";\nimport { useTranslation } from \"react-i18next\";\nimport { ActiveUser } from \"app/components/ActiveUser\";\nimport { UseAppStoreType, AppContext } from \"app/contexts/AppContext\";\nimport { languages } from \"../../../constants\";\nimport ReactCountryFlag from \"react-country-flag\";\n\nconst { Text, Title } = Typography;\n\nexport const ExternalForumList: () => JSX.Element = () => {\n  const navigate = useNavigate();\n  const { t } = useTranslation()\n  const {\n    token: { colorBgContainer, borderRadiusLG },\n  } = theme.useToken();\n  const { turtleMode, topicLanguage, setTopicLanguage } = useContext<UseAppStoreType>(AppContext);\n  const { ndk, saveForums } = useContext<UseNostrStoreType>(NostrContext);\n  const skeletonList = useMemo(() => new Array(10).fill(new NDKEvent()), [])\n  const [externalForums, setExternalForums] = useState<NDKEvent[]>();\n  const [loadingPage, setLoadingPage] = useState<boolean>(true)\n  const [page, setPage] = useState<number>(1)\n  const pageSize = 10\n\n  const columns: TableColumnsType<NDKEvent> = [\n    {\n      dataIndex: 'read',\n      width: 10,\n      render: (_text, record, i) => <Avatar src={turtleMode ? undefined : record.tagValue('image')} icon={<PeopleAltIcon style={{ fontSize: '20px' }} />} />\n    },\n    {\n      dataIndex: 'content',\n      render: (_text, record, i) => {\n        return (\n          <Col span={24}>\n            <Skeleton active loading={!record.id} paragraph={{ rows: 1, width: 300, style: { margin: 0, marginTop: -5 } }} title={{ style: { marginTop: 0 } }}>\n              <Row justify='start'>\n                <Col span={24}>\n                  <Row>\n                    <Text strong>{record.tagValue(\"name\") ?? record.tagValue(\"d\")}</Text>\n                  </Row>\n                  <Row>\n                    <Col span={24}>\n                      <Text type=\"secondary\">{record?.tagValue(\"description\") === \"\" ? \"-\" : record?.tagValue(\"description\") ?? \"-\"}</Text>\n                    </Col>\n                  </Row>\n                </Col>\n              </Row>\n            </Skeleton>\n          </Col>\n        )\n      }\n    },\n  ]\n\n  useEffect(() => {\n    getForumEvents()\n  }, [page])\n\n  const getForumEvents = (newLang?: string): void => {\n    setLoadingPage(true)\n    // @ts-expect-error\n    let filters: NDKFilter = { kinds: [34550], limit: pageSize }\n\n    if (externalForums && !newLang) {\n      const array = Array.from(externalForums);\n      const until = array[array.length - 1]?.created_at ?? 0\n      filters.until = until + 1\n    }\n\n    if (newLang && newLang !== 'all') filters = { ...filters, '#l': [newLang.split(\"-\")[0]] }\n\n    ndk.fetchEvents(filters, { closeOnEose: true }).then((newEvents) => {\n      setExternalForums(events => {\n        return newLang ? [...newEvents] : [...events ?? [], ...newEvents]\n      })\n      saveForums([...newEvents].reduce((accumulator, event) => {\n        if (event.dTag) {\n          accumulator[event.encode()] = event\n          accumulator[event.dTag] = event\n        }\n        return accumulator;\n      }, {}))\n      setLoadingPage(false)\n    })\n  }\n\n  const changeTopicLanguage = (value: string): void => {\n    setTopicLanguage(value)\n    getForumEvents(value)\n  }\n\n  return (\n    <Content>\n      <Row justify='space-between'>\n        <Col xs={24} md={16}>\n          <Row gutter={[0, 10]} >\n            <Col span={24}>\n              <Row justify=\"space-between\">\n                <Breadcrumb\n                  items={[\n                    {\n                      title: <a>Home</a>,\n                      onClick: () => navigate('/')\n                    },\n                    {\n                      title: t(\"pages.externalForumList.title\"),\n                    },\n                  ]}\n                />\n                <Col>\n                  {topicLanguage === 'all' ? (\n                    <LanguageIcon style={{ fontSize: 16, marginRight: 10 }} />\n                  ) : (\n                    <ReactCountryFlag\n                      countryCode={topicLanguage.split('-')[1]}\n                      style={{ fontSize: 16, marginRight: 10 }}\n                    />\n                  )}\n                  <Select\n                    showSearch\n                    style={{ width: 100 }}\n                    size=\"small\"\n                    onChange={changeTopicLanguage}\n                    defaultValue={topicLanguage}\n                    filterOption={(input, option) =>\n                      (option?.label as string ?? '').toLowerCase().includes(input.toLowerCase())\n                    }\n                    options={\n                      [\n                        { value: 'all', label: t('shared.all') },\n                        ...languages\n                          .filter((item, index, self) =>\n                            index === self.findIndex((t) => t.label === item.label)\n                          )\n                          .map(lang => {\n                            return { ...lang, label: t(`language.${lang.label}`) }\n                          }),\n                      ]\n                    }\n                  />\n                </Col>\n              </Row>\n            </Col>\n            <Col span='24'>\n              <Layout\n                style={{ background: colorBgContainer, borderTopLeftRadius: borderRadiusLG, borderTopRightRadius: borderRadiusLG, paddingBottom: 15 }}\n              >\n                <Row justify='space-around' align=\"middle\">\n                  <Col span='20'>\n                    <Row>\n                      <Title>{t(\"pages.externalForumList.title\")}</Title>\n                    </Row>\n                  </Col>\n                </Row>\n              </Layout>\n            </Col>\n            <Layout\n              style={{ background: colorBgContainer, borderRadius: borderRadiusLG }}\n            >\n              <Table pagination={false} columns={columns} dataSource={loadingPage ? skeletonList : [...externalForums ?? []].slice(((page - 1) * pageSize), page * pageSize)} onRow={(record, rowIndex) => {\n                return {\n                  onClick: () => navigate(`/forum/${record.encode()}`)\n                };\n              }} />\n            </Layout>\n            <Col span='24'>\n              <Row justify=\"space-between\">\n                <Button type=\"link\" disabled={page < 2} onClick={() => setPage(p => p - 1)}>{t(\"shared.previous\")}</Button>\n                <Button type=\"link\">{page}</Button>\n                <Button type=\"link\" disabled={(externalForums?.length ?? Infinity) < page * pageSize} onClick={() => setPage(p => p + 1)}>{t(\"shared.next\")}</Button>\n              </Row>\n            </Col>\n          </Row>\n        </Col>\n        <Col xs={0} md={7}>\n          <Row gutter={[0, 10]} style={{ marginTop: 32 }}>\n            <Col span={24}>\n              <ActiveUser />\n            </Col>\n            <Col span={24}>\n              <ForumsButtons />\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n    </Content>\n  )\n}\n"],"names":["Text","Title","Typography","ExternalForumList","_externalForums$lengt","navigate","useNavigate","t","useTranslation","token","colorBgContainer","borderRadiusLG","theme","useToken","turtleMode","topicLanguage","setTopicLanguage","useContext","AppContext","ndk","saveForums","NostrContext","skeletonList","useMemo","Array","fill","NDKEvent","externalForums","setExternalForums","useState","loadingPage","setLoadingPage","page","setPage","columns","dataIndex","width","render","_text","record","i","_jsx","Avatar","src","undefined","tagValue","icon","PeopleAltIcon","style","fontSize","_record$tagValue","_record$tagValue2","Col","span","children","Skeleton","active","loading","id","paragraph","rows","margin","marginTop","title","Row","justify","_jsxs","strong","type","useEffect","getForumEvents","newLang","filters","kinds","limit","_array$created_at","_array","array","from","until","length","created_at","split","fetchEvents","closeOnEose","then","newEvents","events","reduce","accumulator","event","dTag","encode","Content","xs","md","gutter","Breadcrumb","items","onClick","LanguageIcon","marginRight","ReactCountryFlag","countryCode","Select","showSearch","size","onChange","value","defaultValue","filterOption","input","option","_ref","label","toLowerCase","includes","options","languages","filter","item","index","self","findIndex","map","lang","Layout","background","borderTopLeftRadius","borderTopRightRadius","paddingBottom","align","borderRadius","Table","pagination","dataSource","slice","onRow","rowIndex","Button","disabled","p","Infinity","ActiveUser","ForumsButtons"],"sourceRoot":""}