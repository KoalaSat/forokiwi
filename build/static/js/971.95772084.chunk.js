"use strict";(self.webpackChunkforokiwi=self.webpackChunkforokiwi||[]).push([[971],{971:(e,t,s)=>{s.r(t),s.d(t,{NewTopic:()=>z});var n=s(9900),a=s(7170),l=s(7419),i=s(1645),o=s(8125),r=s(481),d=s(6621),c=s(5010),u=s(7021),h=s(5448),p=s(9092),g=s(7385),j=s(6971),x=s(798),v=s(5043),A=s(1690),f=s(2691),b=s(9119);function w(e){return Math.trunc(+(0,b.a)(e)/1e3)}var y=s(1875),m=s(2595),T=s(7763),k=s(9360),C=s(7764),S=s(579);const{Title:L}=n.A,z=()=>{const{language:e,setLanguage:t}=(0,v.useContext)(T.BR),{ndk:s,saveTopics:n,forums:b,saveForums:z,getBaseRelays:R}=(0,v.useContext)(A.gH),{t:B}=(0,p.B)(),{naddr:D}=(0,j.g)(),E=(0,j.Zp)(),{token:{colorBgContainer:H,borderRadiusLG:N}}=a.A.useToken(),[O,V]=(0,v.useState)(),[I,$]=(0,v.useState)(),[G,M]=(0,v.useState)(),[P,Q]=(0,v.useState)();(0,v.useEffect)((()=>(D&&"all"!==D&&(b[D]&&Q(b[D]),s.fetchEvent(D,{closeOnEose:!0}).then((e=>{null!==e&&void 0!==e&&e.dTag&&(Q(e),z({[D]:e,[e.dTag]:e}))}))),()=>{Q(void 0)})),[]),(0,v.useEffect)((()=>{var e;P?$(null!==(e=null===P||void 0===P?void 0:P.tagValue("name"))&&void 0!==e?e:P.tagValue("d")):"all"===D&&$(B("pages.forums.list.all.name"))}),[P]);return(0,S.jsx)(h.UC,{children:(0,S.jsxs)(l.A,{justify:"space-between",children:[(0,S.jsx)(i.A,{xs:24,md:"16",children:(0,S.jsxs)(l.A,{gutter:[0,10],children:[(0,S.jsx)(i.A,{span:24,children:(0,S.jsx)(l.A,{children:(0,S.jsx)(o.A,{items:[{title:(0,S.jsx)("a",{children:"Home"}),onClick:()=>E("/")},{title:I?(0,S.jsx)("a",{children:I}):(0,S.jsx)(r.A,{paragraph:{rows:1,width:55,style:{marginTop:0}},title:!1}),onClick:()=>E(`/forum/${null!==P&&void 0!==P&&P.kind?P.encode():"all"}`)},{title:B("pages.newTopic.createTopic")}]})})}),(0,S.jsx)(i.A,{span:"24",children:(0,S.jsx)(h.Ay,{style:{background:H,borderRadius:N,padding:"15px 0"},children:(0,S.jsxs)(l.A,{justify:"space-around",gutter:[0,10],children:[(0,S.jsxs)(i.A,{span:"22",children:[(0,S.jsx)(l.A,{children:(0,S.jsx)(L,{level:2,children:B("pages.newTopic.title")})}),(0,S.jsx)(l.A,{children:(0,S.jsx)(d.A,{onChange:e=>M(e.target.value)})})]}),(0,S.jsxs)(i.A,{span:"22",children:[(0,S.jsx)(l.A,{children:(0,S.jsx)(L,{level:2,children:B("pages.newTopic.content")})}),(0,S.jsx)(l.A,{children:(0,S.jsx)(x.A,{rows:10,onChange:e=>V(e.target.value)})})]}),(0,S.jsx)(i.A,{span:"22",children:(0,S.jsxs)(l.A,{justify:"end",align:"middle",gutter:[10,0],children:[(0,S.jsx)(i.A,{children:(0,S.jsx)(k.A,{countryCode:e.value.split("-")[1],style:{fontSize:26}})}),(0,S.jsx)(i.A,{children:(0,S.jsx)(c.A,{showSearch:!0,size:"large",style:{width:120},onChange:e=>{const s=C.e.find((t=>e===t.value));s&&t(s)},defaultValue:e.value,filterOption:(e,t)=>{var s;return(null!==(s=null===t||void 0===t?void 0:t.label)&&void 0!==s?s:"").toLowerCase().includes(e.toLowerCase())},options:C.e.filter(((e,t,s)=>t===s.findIndex((t=>t.label===e.label)))).map((e=>({...e,label:B(`language.${e.label}`)})))})}),(0,S.jsx)(i.A,{children:(0,S.jsx)(u.Ay,{disabled:!O||""===O||!G||""===G,type:"primary",htmlType:"submit",size:"large",icon:(0,S.jsx)(g.A,{}),iconPosition:"end",onClick:async()=>{if(D&&O&&G){const a=new f.QB(s);if(a.kind=30023,a.content=O,await a.generateTags(),"all"!==D){var t;const e=null===(t=(0,f.bY)(D))||void 0===t?void 0:t["#a"];e&&a.tags.push(["a",e[0]])}a.tags.push(["title",G]),a.tags.push(["published_at",w(new Date).toString()]),a.tags.push(["L","ISO-639-1"]),a.tags.push(["l",e.value.split("-")[0],"ISO-639-1"]),a.publish((()=>{let e=R();if(P&&P.onRelays.forEach((t=>e.push(t.url))),D){var t,n;const s=m.Qe.decode(D);e=[...e,...null!==(t=null===(n=s.data)||void 0===n?void 0:n.relays)&&void 0!==t?t:[]]}return f.P0.fromRelayUrls(e,s,!0)})()).then((e=>{if(e&&a.dTag){const e=a.encode();n({[a.dTag]:a}),E(`/topic/${e}`)}}))}},children:B("pages.newTopic.createTopic")})})]})})]})})})]})}),(0,S.jsx)(i.A,{xs:0,md:"7",children:(0,S.jsx)(l.A,{gutter:[0,10],style:{marginTop:32},children:(0,S.jsx)(i.A,{span:24,children:(0,S.jsx)(y.G,{})})})})]})})}},7385:(e,t,s)=>{var n=s(4994);t.A=void 0;var a=n(s(39)),l=s(579);t.A=(0,a.default)((0,l.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"}),"NoteAdd")},9119:(e,t,s)=>{function n(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"===typeof e&&"[object Date]"===t?new e.constructor(+e):"number"===typeof e||"[object Number]"===t||"string"===typeof e||"[object String]"===t?new Date(e):new Date(NaN)}s.d(t,{a:()=>n})}}]);
//# sourceMappingURL=971.95772084.chunk.js.map