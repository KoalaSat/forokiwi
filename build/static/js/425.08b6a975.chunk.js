"use strict";(self.webpackChunkforokiwi=self.webpackChunkforokiwi||[]).push([[425],{7425:(e,s,n)=>{n.r(s),n.d(s,{Forum:()=>P});var l=n(9900),i=n(7170),t=n(1645),a=n(7419),d=n(481),r=n(8125),o=n(5010),c=n(7021),u=n(9288),h=n(9472),x=n(2245),v=n(1667),p=n(4659),j=n(6520),g=n(7385),A=n(3344),m=n(518),f=n(4738),y=n(630),w=n(5448),b=n(9092),k=n(2393),S=n(3007),T=n(8639),E=n(6971),R=n(5043),C=n(1690),V=n(2691),$=n(1875),_=n(1144),L=n(7763),M=n(7764),O=n(9360),F=n(579);const{Text:I,Title:z,Link:B}=l.A,P=()=>{var e,s;const{topicLanguage:n,setTopicLanguage:l}=(0,R.useContext)(L.BR),{turtleMode:P}=(0,R.useContext)(L.BR),{ndk:G,authors:N,saveAuthors:H,comments:U,saveComments:W,reactions:D,saveReactions:Q,saveTopics:Y,saveForums:Z,forums:q,getBaseRelays:J}=(0,R.useContext)(C.gH),{token:{colorBgContainer:K,borderRadiusLG:X}}=i.A.useToken(),{naddr:ee}=(0,E.g)(),{t:se}=(0,b.B)(),ne=(0,E.Zp)(),[le,ie]=(0,R.useState)(),[te,ae]=(0,R.useState)(),[de,re]=(0,R.useState)(),[oe,ce]=(0,R.useState)(),[ue,he]=(0,R.useState)(),[xe,ve]=(0,R.useState)(),[pe,je]=(0,R.useState)(!0),[ge,Ae]=(0,R.useState)(!0),[me,fe]=(0,R.useState)(!0),[ye,we]=(0,R.useState)(!0),[be,ke]=(0,R.useState)(!0),[Se,Te]=(0,R.useState)(!0),[Ee,Re]=(0,R.useState)(!0),[Ce,Ve]=(0,R.useState)(1),$e=(0,R.useMemo)((()=>new Array(10).fill(new V.QB)),[]),_e=[{dataIndex:"content",render:(e,s,n)=>{var l,i,r,o,c,u,h,x,v;const j=(0,k.S)(parseInt(null!==(l=null!==(i=s.tagValue("published_at"))&&void 0!==i?i:null===(r=s.created_at)||void 0===r?void 0:r.toString())&&void 0!==l?l:"0",10)),g=(0,S.m)(j,{addSuffix:!0}),A=null===N||void 0===N?void 0:N[s.pubkey],m=pe&&!xe;return(0,F.jsx)(t.A,{span:24,children:(0,F.jsxs)(a.A,{children:[(0,F.jsx)(t.A,{xs:0,md:3,style:{maxWidth:40},children:(0,F.jsx)(a.A,{align:"middle",children:(0,F.jsx)(p.A,{})})}),(0,F.jsxs)(t.A,{xs:24,md:21,children:[(0,F.jsx)(a.A,{children:(0,F.jsx)(t.A,{span:24,children:(0,F.jsx)(d.A,{loading:!s.tagValue("title")&&!s.tagValue("d")||m,active:!0,paragraph:{rows:1,style:{margin:0}},title:!1,children:(0,F.jsx)(I,{strong:!0,children:null!==(o=null!==(c=s.tagValue("title"))&&void 0!==c?c:s.tagValue("d"))&&void 0!==o?o:"-"})})})}),(0,F.jsx)(a.A,{children:(0,F.jsx)(t.A,{span:24,children:(0,F.jsxs)(d.A,{loading:me||m,active:!0,paragraph:{rows:1,style:{margin:0,marginTop:8}},title:!1,children:[(0,F.jsx)(t.A,{xs:0,md:24,children:(0,F.jsx)(I,{type:"secondary",children:`@${null!==(u=null!==(h=null===A||void 0===A?void 0:A.displayName)&&void 0!==h?h:null===A||void 0===A?void 0:A.name)&&void 0!==u?u:se("shared.events.anonymous")} - ${se("shared.events.published_at",{date:g})}`})}),(0,F.jsx)(t.A,{xs:24,md:0,children:(0,F.jsx)(I,{type:"secondary",children:`@${null!==(x=null!==(v=null===A||void 0===A?void 0:A.displayName)&&void 0!==v?v:null===A||void 0===A?void 0:A.name)&&void 0!==x?x:se("shared.events.anonymous")} - ${(0,T.GP)(j,"yy/MM/dd")}`})})]})})})]})]})})}},{dataIndex:"likes",width:15,render:(e,s,n)=>{var l,i,r,o;if(P)return(0,F.jsx)(F.Fragment,{});const c=pe&&!xe;return(0,F.jsx)(a.A,{children:(0,F.jsxs)(t.A,{span:24,children:[(0,F.jsx)(a.A,{justify:"center",children:(0,F.jsx)(j.A,{})}),(0,F.jsx)(a.A,{justify:"center",children:(0,F.jsx)(d.A,{loading:!D[null!==(l=null===s||void 0===s?void 0:s.dTag)&&void 0!==l?l:""]&&be||c,active:!0,paragraph:{rows:1,style:{margin:0,marginTop:6},width:25},title:!1,children:null!==(i=null===(r=D[null!==(o=null===s||void 0===s?void 0:s.dTag)&&void 0!==o?o:""])||void 0===r?void 0:r.length)&&void 0!==i?i:0})})]})})}},{dataIndex:"count",width:15,render:(e,s,n)=>{var l,i,r,o;if(P)return(0,F.jsx)(F.Fragment,{});const c=pe&&!xe;return(0,F.jsx)(a.A,{justify:"space-between",children:(0,F.jsxs)(t.A,{span:24,children:[(0,F.jsx)(a.A,{justify:"center",children:(0,F.jsx)(v.A,{})}),(0,F.jsx)(a.A,{justify:"center",children:(0,F.jsx)(d.A,{loading:!U[null!==(l=null===s||void 0===s?void 0:s.dTag)&&void 0!==l?l:""]&&ye||c,active:!0,paragraph:{rows:1,style:{margin:0,marginTop:6},width:25},title:!1,children:null!==(i=null===(r=U[null!==(o=null===s||void 0===s?void 0:s.dTag)&&void 0!==o?o:""])||void 0===r?void 0:r.length)&&void 0!==i?i:0})})]})})}}];(0,R.useEffect)((()=>(ee&&"all"!==ee&&(q[ee]&&ie(q[ee]),G.fetchEvent(ee,{closeOnEose:!0},Le()).then((e=>{null!==e&&void 0!==e&&e.dTag&&(ie(e),Z({[ee]:e,[e.dTag]:e}))}))),()=>{ie(void 0)})),[]),(0,R.useEffect)((()=>{Oe()}),[Ce]),(0,R.useEffect)((()=>{var e,s;le?(ae(null!==(e=null===le||void 0===le?void 0:le.tagValue("name"))&&void 0!==e?e:le.tagValue("d")),re(null!==(s=null===le||void 0===le?void 0:le.tagValue("description"))&&void 0!==s?s:""),Me(),Fe()):"all"===ee&&(ae(se("pages.forums.list.all.name")),re(se("pages.forums.list.all.description")),je(!1))}),[le]);const Le=()=>{const e=J();return null===le||void 0===le||le.onRelays.forEach((s=>e.push(s.url))),V.P0.fromRelayUrls(e,G,!0)},Me=()=>{P||(Te(!0),le?G.fetchEvents({kinds:[1],"#a":[le.tagReference()[1]],limit:10},{closeOnEose:!0},Le()).then((e=>{const s=[...e].map((e=>e.tags.find((e=>"a"===e[0]&&e[1].startsWith("30023:"))))),n=s.map((e=>{var s,n;return null!==(s=null===e||void 0===e||null===(n=e[1].split(":"))||void 0===n?void 0:n[2])&&void 0!==s?s:""})),l=Array.from(new Set(n));G.fetchEvents({kinds:[30023],"#d":l},{},Le()).then((e=>{he(e),Te(!1),Y([...e].reduce(((e,s)=>(s.dTag&&(e[s.encode()]=s),e)),{}))}))})):Te(!1))},Oe=e=>{Ae(!0),fe(!0),we(!0),ke(!0);let s={kinds:[30023],limit:10};if(oe&&!e){var l,i;const e=Array.from(oe),n=null!==(l=null===(i=e[e.length-1])||void 0===i?void 0:i.created_at)&&void 0!==l?l:0;s.until=n+1}ee&&(s={...s,...(0,V.bY)(ee)}),e?"all"!==e&&(s={...s,"#l":[(null!==n&&void 0!==n?n:e).split("-")[0]]}):"all"!==n&&(s={...s,"#l":[(null!==n&&void 0!==n?n:e).split("-")[0]]}),G.fetchEvents(s,{closeOnEose:!0},Le()).then((s=>{ce((n=>new Set(e?s:[...null!==n&&void 0!==n?n:[],...s]))),Y([...s].reduce(((e,s)=>(s.dTag&&(e[s.encode()]=s),e)),{})),Ie(s),Ae(!1)})).catch((()=>{Ae(!1),ce(new Set)}))},Fe=()=>{if(le){Re(!0);const e=le.getMatchingTags("p");if(e.length>0){je(!0);const s=e.map((e=>e[1]));P?Re(!1):G.fetchEvents({kinds:[0],authors:s},{closeOnEose:!0,groupable:!0},Le()).then((e=>{const s={};e.forEach((e=>{s[e.pubkey]=(0,V.o_)(e)})),H(s),Re(!1)})),G.fetchEvents({kinds:[4550],authors:s},{closeOnEose:!0},Le()).then((e=>{const s=[];e&&[...e].forEach((e=>{const n=e.getMatchingTags("a");n[1]&&s.push(n[1])})),ve(s)})).catch((()=>ve([])))}else je(!1)}},Ie=e=>{const s=[];s.length>0?G.fetchEvents({kinds:[0],authors:s},{closeOnEose:!0,groupable:!0},Le()).then((e=>{const s={};e.forEach((e=>{s[e.pubkey]=(0,V.o_)(e)})),H(s),fe(!1)})):fe(!1),P||e.forEach((e=>{var s;const n=null===(s=e.dTag)||void 0===s?void 0:s.toString();n&&G.fetchEvents({kinds:[1,7],"#a":[`30023:${e.pubkey}:${n}`]},{groupable:!0},Le()).then((e=>{const s=[],l=[];e.forEach((e=>{switch(e.kind){case 1:s.push(e);break;case 7:l.push(e)}})),W({[n]:s}),Q({[n]:l}),ke(!1),we(!1)}))}))};return(0,F.jsx)(w.UC,{children:(0,F.jsxs)(a.A,{justify:"space-between",gutter:[0,10],children:[(0,F.jsx)(t.A,{xs:24,md:16,children:(0,F.jsxs)(a.A,{gutter:[0,10],children:[(0,F.jsx)(t.A,{span:24,children:(0,F.jsxs)(a.A,{justify:"space-between",children:[(0,F.jsx)(r.A,{items:[{title:(0,F.jsx)("a",{children:"Home"}),onClick:()=>ne("/")},{title:null!==te&&void 0!==te?te:(0,F.jsx)(d.A,{paragraph:{rows:1,style:{marginTop:0}},title:!1})}]}),(0,F.jsxs)(t.A,{children:["all"===n?(0,F.jsx)(m.A,{style:{fontSize:16,marginRight:10}}):(0,F.jsx)(O.A,{countryCode:n.split("-")[1],style:{fontSize:16,marginRight:10}}),(0,F.jsx)(o.A,{showSearch:!0,style:{width:100},size:"small",onChange:e=>{l(e),Oe(e)},defaultValue:n,filterOption:(e,s)=>{var n;return(null!==(n=null===s||void 0===s?void 0:s.label)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())},options:[{value:"all",label:se("shared.all")},...M.e.filter(((e,s,n)=>s===n.findIndex((s=>s.label===e.label)))).map((e=>({...e,label:se(`language.${e.label}`)})))]})]})]})}),(0,F.jsx)(t.A,{span:"24",children:(0,F.jsx)(w.Ay,{style:{background:K,borderTopLeftRadius:X,borderTopRightRadius:X,paddingBottom:15},children:(0,F.jsxs)(a.A,{justify:"space-between",align:"middle",children:[(0,F.jsx)(t.A,{span:"1"}),(0,F.jsx)(t.A,{span:"16",children:(0,F.jsxs)(d.A,{active:!0,loading:!te&&!de,paragraph:{rows:1},style:{marginTop:26},children:[(0,F.jsx)(a.A,{children:(0,F.jsx)(z,{children:te})}),(0,F.jsx)(a.A,{children:(0,F.jsx)(I,{type:"secondary",children:de})})]})}),(0,F.jsx)(t.A,{xs:0,md:4,children:(0,F.jsx)(a.A,{justify:"end",children:(0,F.jsx)(c.Ay,{type:"primary",htmlType:"submit",size:"large",icon:(0,F.jsx)(g.A,{}),iconPosition:"end",onClick:()=>ne(`/forum/${ee}/new`),children:(0,F.jsx)(t.A,{xs:0,md:20,children:se("pages.forum.createTopic")})})})}),(0,F.jsx)(t.A,{span:"1"})]})})}),(0,F.jsx)(t.A,{span:"24",children:(0,F.jsx)(w.Ay,{style:{background:K,borderRadius:X},children:(0,F.jsx)(u.A,{pagination:!1,columns:_e,dataSource:ge||pe&&!xe?$e:[...null!==oe&&void 0!==oe?oe:[]].filter((e=>{var s;return!pe||(null===xe||void 0===xe?void 0:xe.includes(null!==(s=e.dTag)&&void 0!==s?s:""))})).slice(10*(Ce-1),10*Ce),onRow:(e,s)=>({onClick:()=>ne(`/topic/${e.encode()}`)})})})}),(0,F.jsx)(t.A,{span:"24",children:(0,F.jsxs)(a.A,{justify:"space-between",children:[(0,F.jsx)(c.Ay,{type:"link",disabled:Ce<2,onClick:()=>Ve((e=>e-1)),children:se("shared.previous")}),(0,F.jsx)(c.Ay,{type:"link",children:Ce}),(0,F.jsx)(c.Ay,{type:"link",disabled:(null!==(e=null===oe||void 0===oe?void 0:oe.size)&&void 0!==e?e:1/0)<10*Ce,onClick:()=>Ve((e=>e+1)),children:se("shared.next")})]})})]})}),(0,F.jsx)(t.A,{xs:24,md:7,children:(0,F.jsxs)(a.A,{gutter:[0,10],style:{marginTop:32},children:[(0,F.jsx)(t.A,{xs:0,md:24,children:(0,F.jsx)($.G,{})}),(0,F.jsx)(t.A,{xs:0,md:24,children:(0,F.jsx)(_.O,{})}),(0,F.jsx)(t.A,{span:24,children:!P&&"all"!==ee&&(0,F.jsxs)(w.Ay,{style:{padding:"24px 0",background:K,borderRadius:X},children:[(0,F.jsx)(a.A,{justify:"space-around",children:(0,F.jsx)(t.A,{span:"16",children:(0,F.jsxs)(z,{level:2,children:[(0,F.jsx)(f.A,{}),se("pages.forum.hotRopics")]})})}),(0,F.jsx)(a.A,{justify:"space-around",children:(0,F.jsx)(t.A,{span:"16",children:(0,F.jsxs)(d.A,{active:!0,loading:Se,title:!1,paragraph:{rows:5},children:[[...null!==ue&&void 0!==ue?ue:[]].map(((e,s)=>{var n,l,i,d,r;return e.tagValue("title")?(0,F.jsxs)(a.A,{justify:"space-between",onClick:()=>ne(`/topic/${e.encode()}`),children:[(0,F.jsx)(t.A,{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:(0,F.jsx)(B,{strong:!0,children:null!==(n=null!==(l=e.tagValue("title"))&&void 0!==l?l:e.tagValue("d"))&&void 0!==n?n:"-"})}),(0,F.jsx)(t.A,{children:(0,F.jsx)(I,{children:(0,S.m)((0,k.S)(parseInt(null!==(i=null!==(d=null===e||void 0===e?void 0:e.tagValue("published_at"))&&void 0!==d?d:null===e||void 0===e||null===(r=e.created_at)||void 0===r?void 0:r.toString())&&void 0!==i?i:"0",10)),{addSuffix:!0})})})]},s):(0,F.jsx)(F.Fragment,{})})),0===(null===ue||void 0===ue?void 0:ue.size)?(0,F.jsx)(h.A,{image:h.A.PRESENTED_IMAGE_SIMPLE}):(0,F.jsx)(F.Fragment,{})]})})})]})}),(0,F.jsx)(t.A,{span:24,children:!P&&"all"!==ee&&(0,F.jsxs)(w.Ay,{style:{padding:"24px 0",background:K,borderRadius:X},children:[(0,F.jsx)(a.A,{justify:"space-around",children:(0,F.jsx)(t.A,{span:"16",children:(0,F.jsxs)(z,{level:2,children:[(0,F.jsx)(y.A,{}),se("pages.forum.moderators")]})})}),(0,F.jsx)(a.A,{justify:"space-around",children:(0,F.jsx)(t.A,{span:"16",children:(0,F.jsxs)(d.A,{active:!0,loading:!le&&Ee,title:!1,paragraph:{rows:3},children:[[...null!==(s=null===le||void 0===le?void 0:le.getMatchingTags("p"))&&void 0!==s?s:[]].map(((e,s)=>{var n,l;if(!e[1])return(0,F.jsx)(F.Fragment,{});const i=N[e[1]],d=new V.VT({hexpubkey:e[1]});return(0,F.jsx)(a.A,{justify:"space-between",children:(0,F.jsxs)(t.A,{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:[(0,F.jsx)(x.A,{src:null===i||void 0===i?void 0:i.image,icon:(0,F.jsx)(A.A,{style:{fontSize:"20px"}})}),(0,F.jsx)(B,{strong:!0,href:`https://njump.me/${d.npub}`,target:"_blank",style:{marginLeft:5},children:null!==(n=null!==(l=null===i||void 0===i?void 0:i.name)&&void 0!==l?l:e[1])&&void 0!==n?n:"-"})]})},s)})),pe?(0,F.jsx)(F.Fragment,{}):(0,F.jsx)(I,{strong:!0,style:{marginLeft:5},children:se("pages.forum.noModerators")})]})})})]})})]})})]})})}}}]);
//# sourceMappingURL=425.08b6a975.chunk.js.map