"use strict";(self.webpackChunkforokiwi=self.webpackChunkforokiwi||[]).push([[885],{971:(e,t,n)=>{n.r(t),n.d(t,{NewTopic:()=>y});var s=n(9900),a=n(7170),i=n(7419),r=n(1645),c=n(8125),o=n(481),l=n(6621),d=n(7021),u=n(5448),h=n(9092),p=n(7385),j=n(6971),g=n(798),x=n(5043),v=n(1690),A=n(2691),f=n(9119);function w(e){return Math.trunc(+(0,f.a)(e)/1e3)}var m=n(1875),b=n(579);const{Title:T}=s.A,y=()=>{const{ndk:e,saveTopics:t,forums:n,saveForums:s}=(0,x.useContext)(v.gH),{t:f}=(0,h.B)(),{naddr:y}=(0,j.g)(),C=(0,j.Zp)(),{token:{colorBgContainer:k,borderRadiusLG:S}}=a.A.useToken(),[z,D]=(0,x.useState)(),[E,H]=(0,x.useState)(),[N,B]=(0,x.useState)(),[L,M]=(0,x.useState)();(0,x.useEffect)((()=>(y&&"all"!==y&&(n[y]&&M(n[y]),e.fetchEvent(y,{closeOnEose:!0}).then((e=>{null!==e&&void 0!==e&&e.dTag&&(M(e),s({[y]:e,[e.dTag]:e}))}))),()=>{M(void 0)})),[]),(0,x.useEffect)((()=>{var e;L&&H(null!==(e=null===L||void 0===L?void 0:L.tagValue("name"))&&void 0!==e?e:L.tagValue("d"))}),[L]);return(0,b.jsx)(u.UC,{children:(0,b.jsxs)(i.A,{justify:"space-between",children:[(0,b.jsx)(r.A,{xs:24,md:"16",children:(0,b.jsxs)(i.A,{gutter:[0,10],children:[(0,b.jsx)(r.A,{span:24,children:(0,b.jsx)(i.A,{children:(0,b.jsx)(c.A,{items:[{title:(0,b.jsx)("a",{children:"Home"}),onClick:()=>C("/")},{title:E?(0,b.jsx)("a",{children:E}):(0,b.jsx)(o.A,{paragraph:{rows:1,width:55,style:{marginTop:0}},title:!1}),onClick:()=>C(`/forum/${null!==L&&void 0!==L&&L.kind?L.encode():"all"}`)},{title:f("pages.newTopic.createTopic")}]})})}),(0,b.jsx)(r.A,{span:"24",children:(0,b.jsx)(u.Ay,{style:{background:k,borderRadius:S,padding:"15px 0"},children:(0,b.jsxs)(i.A,{justify:"space-around",gutter:[0,10],children:[(0,b.jsxs)(r.A,{span:"22",children:[(0,b.jsx)(i.A,{children:(0,b.jsx)(T,{level:2,children:f("pages.newTopic.title")})}),(0,b.jsx)(i.A,{children:(0,b.jsx)(l.A,{onChange:e=>B(e.target.value)})})]}),(0,b.jsxs)(r.A,{span:"22",children:[(0,b.jsx)(i.A,{children:(0,b.jsx)(T,{level:2,children:f("pages.newTopic.content")})}),(0,b.jsx)(i.A,{children:(0,b.jsx)(g.A,{rows:10,onChange:e=>D(e.target.value)})})]}),(0,b.jsx)(r.A,{span:"22",children:(0,b.jsx)(i.A,{justify:"end",children:(0,b.jsx)(d.Ay,{disabled:!z||""===z||!N||""===N,type:"primary",htmlType:"submit",size:"large",icon:(0,b.jsx)(p.A,{}),iconPosition:"end",onClick:async()=>{if(y&&z&&N){var n;const s=null===(n=(0,A.bY)(y))||void 0===n?void 0:n["#a"];if(null!==s&&void 0!==s&&s[0]){const n=new A.QB(e);n.kind=30023,n.content=z,await n.generateTags(),n.tags.push(["a",null===s||void 0===s?void 0:s[0]]),n.tags.push(["title",N]),n.tags.push(["published_at",w(new Date).toString()]),n.publish().then((e=>{if(e&&n.dTag){const e=n.encode();t({[n.dTag]:n}),C(`/topic/${e}`)}}))}}},children:f("pages.newTopic.createTopic")})})})]})})})]})}),(0,b.jsx)(r.A,{xs:0,md:"7",children:(0,b.jsx)(i.A,{gutter:[0,10],style:{marginTop:32},children:(0,b.jsx)(r.A,{span:24,children:(0,b.jsx)(m.G,{})})})})]})})}},7385:(e,t,n)=>{var s=n(4994);t.A=void 0;var a=s(n(39)),i=n(579);t.A=(0,a.default)((0,i.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"}),"NoteAdd")},2619:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(8168),a=n(5043);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"};var r=n(2575),c=function(e,t){return a.createElement(r.A,(0,s.A)({},e,{ref:t,icon:i}))};const o=a.forwardRef(c)},9119:(e,t,n)=>{function s(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"===typeof e&&"[object Date]"===t?new e.constructor(+e):"number"===typeof e||"[object Number]"===t||"string"===typeof e||"[object String]"===t?new Date(e):new Date(NaN)}n.d(t,{a:()=>s})}}]);
//# sourceMappingURL=885.851a25d1.chunk.js.map