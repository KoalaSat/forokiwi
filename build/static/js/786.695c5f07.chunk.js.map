{"version":3,"file":"static/js/786.695c5f07.chunk.js","mappings":"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","sources":["app/pages/ExternalForumList/index.tsx"],"sourcesContent":["import { Avatar, Breadcrumb, Button, Col, Row, Skeleton, Table, TableColumnsType, Typography, theme } from \"antd\";\nimport Layout, { Content } from \"antd/es/layout/layout\"\nimport PeopleAltIcon from '@mui/icons-material/PeopleAlt';\nimport { useContext, useEffect, useMemo, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { ForumsButtons } from \"app/components/ForumsButtons\";\nimport { NDKEvent, NDKFilter } from \"@nostr-dev-kit/ndk\";\nimport { UseNostrStoreType, NostrContext } from \"app/contexts/NostrContext\";\nimport { useTranslation } from \"react-i18next\";\nimport { ActiveUser } from \"app/components/ActiveUser\";\nimport { UseAppStoreType, AppContext } from \"app/contexts/AppContext\";\n\nconst { Text, Title } = Typography;\n\nexport const ExternalForumList: () => JSX.Element = () => {\n  const navigate = useNavigate();\n  const { t } = useTranslation()\n  const {\n    token: { colorBgContainer, borderRadiusLG },\n  } = theme.useToken();\n  const { turtleMode } = useContext<UseAppStoreType>(AppContext);\n  const { ndk, saveForums } = useContext<UseNostrStoreType>(NostrContext);\n  const skeletonList = useMemo(() => new Array(10).fill(new NDKEvent()), [])\n  const [externalForums, setExternalForums] = useState<NDKEvent[]>();\n  const [loadingPage, setLoadingPage] = useState<boolean>(true)\n  const [page, setPage] = useState<number>(1)\n  const pageSize = 10\n\n  const columns: TableColumnsType<NDKEvent> = [\n    {\n      dataIndex: 'read',\n      width: 10,\n      render: (_text, record, i) => <Avatar src={turtleMode ? undefined : record.tagValue('image')} icon={<PeopleAltIcon style={{ fontSize: '20px' }} />} />\n    },\n    {\n      dataIndex: 'content',\n      render: (_text, record, i) => {\n        return (\n          <Col span={24}>\n            <Skeleton active loading={!record.id} paragraph={{ rows: 1, width: 300, style: { margin: 0, marginTop: -5 } }} title={{ style: { marginTop: 0 } }}>\n              <Row justify='start'>\n                <Col span={24}>\n                  <Row>\n                    <Text strong>{record.tagValue(\"name\") ?? record.tagValue(\"d\")}</Text>\n                  </Row>\n                  <Row>\n                    <Col span={24}>\n                      <Text type=\"secondary\">{record?.tagValue(\"description\") === \"\" ? \"-\" : record?.tagValue(\"description\") ?? \"-\"}</Text>\n                    </Col>\n                  </Row>\n                </Col>\n              </Row>\n            </Skeleton>\n          </Col>\n        )\n      }\n    },\n  ]\n\n  useEffect(() => {\n    getForumEvents()\n  }, [page])\n\n  const getForumEvents = (): void => {\n    setLoadingPage(true)\n    if (page * pageSize > (externalForums?.length ?? 0)) {\n      // @ts-expect-error\n      const filters: NDKFilter = { kinds: [34550], limit: pageSize }\n\n      if (externalForums) {\n        const array = Array.from(externalForums);\n        const until = array[array.length - 1]?.created_at ?? 0\n        filters.until = until + 1\n      }\n\n      ndk.fetchEvents(filters, { closeOnEose: true }).then((newEvents) => {\n        setExternalForums(events => [...events ?? [], ...newEvents])\n        saveForums([...newEvents].reduce((accumulator, event) => {\n          if (event.dTag) {\n            accumulator[event.encode()] = event\n            accumulator[event.dTag] = event\n          }\n          return accumulator;\n        }, {}))\n        setLoadingPage(false)\n      })\n    } else {\n      setLoadingPage(false)\n    }\n  }\n\n  return (\n    <Content>\n      <Row justify='space-between'>\n        <Col xs={24} md={16}>\n          <Row gutter={[0, 10]} >\n            <Col span={24}>\n              <Row>\n                <Breadcrumb\n                  items={[\n                    {\n                      title: <a>Home</a>,\n                      onClick: () => navigate('/')\n                    },\n                    {\n                      title: t(\"pages.externalForumList.title\"),\n                    },\n                  ]}\n                />\n              </Row>\n            </Col>\n            <Col span='24'>\n              <Layout\n                style={{ background: colorBgContainer, borderTopLeftRadius: borderRadiusLG, borderTopRightRadius: borderRadiusLG, paddingBottom: 15 }}\n              >\n                <Row justify='space-around' align=\"middle\">\n                  <Col span='20'>\n                    <Row>\n                      <Title>{t(\"pages.externalForumList.title\")}</Title>\n                    </Row>\n                  </Col>\n                </Row>\n              </Layout>\n            </Col>\n            <Layout\n              style={{ background: colorBgContainer, borderRadius: borderRadiusLG }}\n            >\n              <Table pagination={false} columns={columns} dataSource={loadingPage ? skeletonList : [...externalForums ?? []].slice(((page - 1) * pageSize), page * pageSize)} onRow={(record, rowIndex) => {\n                return {\n                  onClick: () => navigate(`/forum/${record.encode()}`)\n                };\n              }} />\n            </Layout>\n            <Col span='24'>\n              <Row justify=\"space-between\">\n                <Button type=\"link\" disabled={page < 2} onClick={() => setPage(p => p - 1)}>{t(\"shared.previous\")}</Button>\n                <Button type=\"link\">{page}</Button>\n                <Button type=\"link\" disabled={(externalForums?.length ?? Infinity) < page * pageSize} onClick={() => setPage(p => p + 1)}>{t(\"shared.next\")}</Button>\n              </Row>\n            </Col>\n          </Row>\n        </Col>\n        <Col xs={0} md={7}>\n          <Row gutter={[0, 10]} style={{ marginTop: 32 }}>\n            <Col span={24}>\n              <ActiveUser />\n            </Col>\n            <Col span={24}>\n              <ForumsButtons />\n            </Col>\n          </Row>\n        </Col>\n      </Row>\n    </Content>\n  )\n}\n"],"names":["Text","Title","Typography","ExternalForumList","_externalForums$lengt2","navigate","useNavigate","t","useTranslation","token","colorBgContainer","borderRadiusLG","theme","useToken","turtleMode","useContext","AppContext","ndk","saveForums","NostrContext","skeletonList","useMemo","Array","fill","NDKEvent","externalForums","setExternalForums","useState","loadingPage","setLoadingPage","page","setPage","columns","dataIndex","width","render","_text","record","i","_jsx","Avatar","src","undefined","tagValue","icon","PeopleAltIcon","style","fontSize","_record$tagValue","_record$tagValue2","Col","span","children","Skeleton","active","loading","id","paragraph","rows","margin","marginTop","title","Row","justify","_jsxs","strong","type","useEffect","getForumEvents","_externalForums$lengt","length","filters","kinds","limit","_array$created_at","_array","array","from","until","created_at","fetchEvents","closeOnEose","then","newEvents","events","reduce","accumulator","event","dTag","encode","Content","xs","md","gutter","Breadcrumb","items","onClick","Layout","background","borderTopLeftRadius","borderTopRightRadius","paddingBottom","align","borderRadius","Table","pagination","dataSource","slice","onRow","rowIndex","Button","disabled","p","Infinity","ActiveUser","ForumsButtons"],"sourceRoot":""}